{% extends 'menu/basemenu.html' %}                      <!-- ARQUIVO DE ABERTURA DE TICKET -->
{% load static %}

{% block title %}Sistema de Abertura de Chamados - Citiesoft{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'menu/css/style_chamados.css' %}">
{% endblock %}

{% block content %}
<div class="chamados-system">
    <!-- Mobile Header -->
    <div class="mobile-header">
        <button class="navbar-toggler" id="sidebarToggle">
            <i class="fas fa-bars"></i>
        </button>
        <div class="company-logo-mobile">
            <h2 class="company-logo-text">Citiesoft</h2>
        </div>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- Sidebar -->
    <div class="sidebar">
        <i class="fas fa-bars sidebar-collapsed-icon"></i>
        
        <div class="sidebar-content">
            <div class="sidebar-header">
                <div class="company-logo">
                    <h2 class="company-logo-text">Citiesoft</h2>
                </div>
            </div>

            <div class="user-info">
                <div class="user-avatar">AD</div>
                <div class="user-details">
                    <div class="user-name">Administrador</div>
                    <div class="user-role">Sistema</div>
                </div>
            </div>

            <div class="sidebar-menu-container">
                <ul class="nav flex-column" id="dynamicMenu">
                    <!-- Menu será carregado via JavaScript -->
                </ul>
            </div>
        </div>

        <div class="sidebar-footer">
            <button type="button" class="btn-logout" id="logoutButton">
                <i class="fas fa-sign-out-alt"></i>
                <span>Sair do Sistema</span>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="top-bar-left">
                <div class="top-bar-logo">
                    <h2 class="top-bar-logo-text">Citiesoft</h2>
                </div>
            </div>
            <div class="top-bar-status-container">
                <div class="top-bar-status">
                    <span class="status-indicator"></span>
                    <span>Online</span>
                </div>
            </div>
        </div>

        <!-- Container do Formulário -->
        <div class="container">
            <!-- Mensagem de Sucesso -->
            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle"></i>
                Chamado enviado com sucesso! Em breve nossa equipe entrará em contato.
            </div>
            
            <!-- Card do Formulário -->
            <div class="form-card">
                <div class="form-header">
                    <i class="fas fa-headset"></i>
                    <h1>Descreva o incidente ou a requisição</h1>
                </div>
                
                <form id="chamadoForm">
                    {% csrf_token %}
                    <!-- Categoria -->
                    <div class="form-group">
                        <label for="categoria" class="required">
                            <i class="fas fa-folder-open"></i> Categoria
                        </label>
                        <button type="button" class="category-trigger" id="categoryTrigger">
                            <span>Selecione uma categoria...</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <input type="hidden" id="categoria" name="categoria" required>
                    </div>

                    <!-- Especialidade -->
                    <div class="form-group">
                        <label for="especialidade" class="required">
                            <i class="fas fa-tools"></i> Tipo de Especialidade
                        </label>
                        <select id="especialidade" name="especialidade" required>
                            <option value="">Selecione o tipo de serviço...</option>
                            <option value="ti">TI / Informática</option>
                            <option value="infraestrutura">Infraestrutura</option>
                            <option value="redes">Redes e Conectividade</option>
                            <option value="software">Software e Aplicativos</option>
                            <option value="hardware">Hardware e Equipamentos</option>
                            <option value="telefonia">Telefonia</option>
                            <option value="seguranca">Segurança da Informação</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    
                    <!-- Observadores -->
                    <div class="form-group">
                        <label for="observadores">
                            <i class="fas fa-users"></i> Observadores
                        </label>
                        <input type="text" id="observadores" name="observadores" placeholder="Pessoas que devem acompanhar este chamado">
                    </div>
                    
                    <!-- Localização -->
                    <div class="form-group">
                        <label for="localizacao">
                            <i class="fas fa-map-marker-alt"></i> Localização
                        </label>
                        <input type="text" id="localizacao" name="localizacao" placeholder="Onde o problema ocorre">
                    </div>
                    
                    <!-- Título -->
                    <div class="form-group">
                        <label for="titulo" class="required">
                            <i class="fas fa-heading"></i> Título
                        </label>
                        <input type="text" id="titulo" name="titulo" placeholder="Resumo do problema" required>
                    </div>
                    
                    <!-- Descrição -->
                    <div class="form-group">
                        <label for="descricao" class="required">
                            <i class="fas fa-align-left"></i> Descrição
                        </label>
                        <div class="editor-toolbar">
                            <button type="button" class="toolbar-btn" id="btnBold" title="Negrito">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button type="button" class="toolbar-btn" id="btnItalic" title="Itálico">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button type="button" class="toolbar-btn" id="btnUnderline" title="Sublinhado">
                                <i class="fas fa-underline"></i>
                            </button>
                            <button type="button" class="toolbar-btn" id="btnList" title="Lista">
                                <i class="fas fa-list-ul"></i>
                            </button>
                        </div>
                        <textarea id="descricao" name="descricao" placeholder="Descreva detalhadamente o problema ou solicitação..." required></textarea>
                    </div>
                    
                    <!-- Upload de Arquivos -->
                    <div class="form-group">
                        <label for="arquivos">
                            <i class="fas fa-paperclip"></i> Arquivo(s) (60 MB máx.)
                        </label>
                        <div class="upload-area" id="uploadArea">
                            <i class="fas fa-cloud-upload-alt upload-icon"></i>
                            <p>Arraste e solte seu arquivo aqui, ou</p>
                            <button type="button" class="btn-upload" id="btnEscolherArquivo">
                                <i class="fas fa-folder-open"></i> Escolher arquivos
                            </button>
                            <input type="file" id="arquivos" name="arquivos" class="file-input" multiple>
                        </div>
                        <div class="file-list" id="fileList"></div>
                    </div>
                    
                    <!-- Botões de Ação -->
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" id="btnLimpar">
                            <i class="fas fa-eraser"></i> Limpar
                        </button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-paper-plane"></i> Enviar Chamado
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Footer -->
            <div class="footer">
                <p><i class="fas fa-building"></i> Acriminizativo UPLA - Sistema de Gestão de Chamados</p>
            </div>
        </div>

        <!-- Modal de Seleção de Categoria -->
        <div class="modal" id="categoryModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-list"></i> Selecione a categoria desejada</h2>
                    <button class="modal-close" id="modalClose">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="search-container">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" class="search-input" id="searchCategory" placeholder="Pesquisar categoria...">
                    </div>
                    
                    <div class="categories-grid">
                        <div class="category-section">
                            <div class="section-header">
                                <i class="fas fa-home"></i> Home
                            </div>
                            <ul class="category-list">
                                <li class="category-item" data-category="infraestrutura">
                                    <i class="fas fa-building"></i>
                                    <span class="category-name">INFRAESTRUTURA</span>
                                </li>
                                <li class="category-item" data-category="suporte-tecnico">
                                    <i class="fas fa-laptop-code"></i>
                                    <span class="category-name">SUPORTE TÉCNICO</span>
                                </li>
                            </ul>
                        </div>
                        
                        <div class="category-section">
                            <div class="section-header">
                                <i class="fas fa-shield-alt"></i> SEGURANÇA DA INFORMAÇÃO
                            </div>
                            <ul class="category-list">
                                <li class="category-item" data-category="seguranca-info">
                                    <i class="fas fa-lock"></i>
                                    <span class="category-name">SEGURANÇA DA INFORMAÇÃO</span>
                                </li>
                                <li class="category-item" data-category="telefonia">
                                    <i class="fas fa-phone-alt"></i>
                                    <span class="category-name">TELEFONIA</span>
                                </li>
                            </ul>
                        </div>
                        
                        <div class="category-section">
                            <div class="section-header">
                                <i class="fas fa-user-shield"></i> SEGURANÇA/VIGILÂNCIA
                            </div>
                            <ul class="category-list">
                                <li class="category-item" data-category="seguranca-vigilancia">
                                    <i class="fas fa-video"></i>
                                    <span class="category-name">SEGURANÇA/VIGILÂNCIA</span>
                                </li>
                                <li class="category-item" data-category="suporte-sistemas">
                                    <i class="fas fa-cogs"></i>
                                    <span class="category-name">SUPORTE A SISTEMAS</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="modalCancel">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                    <button class="btn btn-primary" id="modalConfirm">
                        <i class="fas fa-check"></i> Selecionar
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'menu/js/script_chamados.js' %}"></script>
{% endblock %}